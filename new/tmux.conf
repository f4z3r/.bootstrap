# ============================================= #
# Start with defaults from the Sensible plugin  #
# --------------------------------------------- #
run-shell /nix/store/3ixqzlr8vm4m7q3k1zk1f7jmbjiysl5v-tmuxplugin-sensible-unstable-2017-09-05/share/tmux-plugins/sensible/sensible.tmux
# ============================================= #

set  -g default-terminal "screen"
set  -g base-index      0
setw -g pane-base-index 0





set -g status-keys vi
set -g mode-keys   vi

bind -N "Select pane to the left of the active pane" h select-pane -L
bind -N "Select pane below the active pane" j select-pane -D
bind -N "Select pane above the active pane" k select-pane -U
bind -N "Select pane to the right of the active pane" l select-pane -R

bind -r -N "Resize the pane left by 5" \
  H resize-pane -L 5
bind -r -N "Resize the pane down by 5" \
  J resize-pane -D 5
bind -r -N "Resize the pane up by 5" \
  K resize-pane -U 5
bind -r -N "Resize the pane right by 5" \
  L resize-pane -R 5


# rebind main key: C-a
unbind C-b
set -g prefix C-a
bind -N "Send the prefix key through to the application" \
  a send-prefix
bind C-a last-window




set  -g mouse             off
setw -g aggressive-resize on
setw -g clock-mode-style  24
set  -s escape-time       0
set  -g history-limit     10000

# ============================================= #
# Load plugins with Home Manager                #
# --------------------------------------------- #

# tmuxplugin-yank
# ---------------------
set -g @yank_selection 'clipboard'
set -g @yank_action 'copy-pipe'
set -g @shell_mode 'vi'

run-shell /nix/store/1xq52qqiidhjr9m0fa11gbhxsa0mnkhl-tmuxplugin-yank-unstable-2021-06-20/share/tmux-plugins/yank/yank.tmux


# tmuxplugin-copycat
# ---------------------
set -g @override_copy_command "(xsel -cb && xsel -bi)"
run-shell /nix/store/pxdk48qi8ykchmwdc05ffrlcfmfqhspb-tmuxplugin-copycat-unstable-2020-01-09/share/tmux-plugins/copycat/copycat.tmux

# ============================================= #

# turn of mouse
set -g mouse off

set -g status on

# improve default name of windows
set-option -g automatic-rename-format '#{b:pane_current_path}: #{b:pane_current_command}'

# minimal status bar
set-option -g status-style bg=colour237,fg=colour223
set-option -g status-left ""
set-option -g status-right ""
set -g status-justify centre
set-window-option -g window-status-separator "    "
set-window-option -g window-status-current-format "#{?window_zoomed_flag,#[fg=colour214],}"
set-window-option -g window-status-format ""

# fix coloring for tmux
set -g default-terminal "screen-256color"
set -ga terminal-overrides ",xterm-256color:Tc"

# override suspend
bind-key C-z resize-pane -Z

# vim like pane movement
bind-key C-h select-pane -t '{left-of}'
bind-key C-l select-pane -t '{right-of}'
bind-key C-k select-pane -t '{up-of}'
bind-key C-n select-pane -t '{down-of}'

# resize with arrow keys
bind-key Right resize-pane -R 20
bind-key Left resize-pane -L 20
bind-key Up resize-pane -U 20
bind-key Down resize-pane -D 20

# Similar split to screen
bind-key | split-window -h -c "#{pane_current_path}"
bind-key - split-window -v -c "#{pane_current_path}"

# ensure all window are in same working dir
bind-key a last-window
bind-key c new-window -c "#{pane_current_path}"
bind-key % split-window -h -c "#{pane_current_path}"
bind-key '"' split-window -v -c "#{pane_current_path}"

# use v to select line and r for rectangle selection
bind-key -T copy-mode-vi v send-keys -X begin-selection
bind-key -T copy-mode-vi r send-keys -X rectangle-toggle
# easy scrolling
bind-key -T copy-mode-vi C-k send-keys -X scroll-up
bind-key -T copy-mode-vi C-n send-keys -X scroll-down
bind-key -T copy-mode-vi C-l send-keys -X end-of-line
bind-key -T copy-mode-vi C-h send-keys -X start-of-line
bind-key -T copy-mode-vi n send-keys -X cursor-down
bind-key -T copy-mode-vi k send-keys -X cursor-up
bind-key -T copy-mode-vi h send-keys -X cursor-left
bind-key -T copy-mode-vi l send-keys -X cursor-right
bind-key -T copy-mode-vi j send-keys -X search-again
bind-key -T copy-mode-vi J send-keys -X search-reverse
